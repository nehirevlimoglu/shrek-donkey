{% extends 'base.html' %}
{% load static %}

{% block title %}Create Job Listing | Swamp Hiring{% endblock %}

{% block extra_css %}
    <link rel="stylesheet" href="{% static 'css/employer_create_job_listing.css' }}">
{% endblock %}

{% block content %}
    <div class="job-form-container">
        <h2>Create a New Job Listing</h2>

        <!-- Success Message -->
        {% if messages %}
            {% for message in messages %}
                <div class="alert alert-success alert-dismissible fade show" role="alert">
                    {{ message }}
                    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
            {% endfor %}
        {% endif %}

        <form method="POST">
            {% csrf_token %}

            <div class="form-group">
                <label for="title">Job Title</label>
                <input type="text" id="title" name="title" required>
            </div>

            <div class="form-group">
                <label for="position">Position</label>
                <select id="position" name="position">
                    <option value="">Loading positions...</option>  <!-- Default loading text -->
                </select>
            </div>

            <!-- ðŸ”¹ Company Name (Now Editable) -->
            <div class="form-group">
                <label for="company_name">Company Name</label>
                <input type="text" id="company_name" name="company_name" 
                       value="{{ request.user.employer.company_name|default:'' }}" 
                       required>
            </div>

            <!-- ðŸ”¹ Location (Now Editable) -->
            <div class="form-group">
                <label for="location">Location</label>
                <input type="text" id="location" name="location" 
                       value="{{ request.user.employer.company_location|default:'' }}" 
                       required>
            </div>

            <div class="form-group">
                <label for="job_type">Job Type</label>
                <select id="job_type" name="job_type">
                    <option value="Full Time">Full-Time</option>
                    <option value="Part Time">Part-Time</option>
                    <option value="Internship">Internship</option>
                    <option value="Apprenticeship">Apprenticeship</option>
                </select>
            </div>

            <div class="form-group">
                <label for="salary">Salary (Optional)</label>
                <input type="number" id="salary" name="salary">
            </div>

            <div class="form-group">
                <label for="description">Job Description</label>
                <textarea id="description" name="description" rows="4" required></textarea>
            </div>

            <div class="form-group">
                <label for="requirements">Requirements</label>
                <textarea id="requirements" name="requirements" rows="4" required></textarea>
            </div>

            <div class="form-group">
                <label for="benefits">Benefits (Optional)</label>
                <textarea id="benefits" name="benefits" rows="4"></textarea>
            </div>

            <div class="form-group">
                <label for="application_deadline">Application Deadline</label>
                <input type="date" id="application_deadline" name="application_deadline">
            </div>

            <!-- ðŸ”¹ Contact Email (Now Editable) -->
            <div class="form-group">
                <label for="contact_email">Contact Email</label>
                <input type="email" id="contact_email" name="contact_email" 
                       value="{{ request.user.employer.email|default:'' }}" 
                       required>
            </div>

            <button type="submit" class="big-button">Create Job</button>
        </form>
    </div>

    <!-- Include JavaScript file -->
    <script src="{% static 'js/load_job_titles.js' %}"></script>

    <!-- Auto-hide success message -->
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            setTimeout(function() {
                let alerts = document.querySelectorAll('.alert');
                alerts.forEach(alert => alert.style.display = 'none');
            }, 4000);  // Hide after 4 seconds
        });
    </script>
{% endblock %}
